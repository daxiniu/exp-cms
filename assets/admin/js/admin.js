var dxn=window.dxn||{};
dxn.util=function(c){var a=dxn.PAGEENV,f=a.param;return{base:a.base,param:{set:function(d){c.extend(f,d);window.location.search=c.param(f)},get:function(d){return f[d]||""}},version:a.version,format:function(d,h){d=String(d);if("undefined"!==typeof h)if("[object Object]"===Object.prototype.toString.call(h))return d.replace(/\$\{(\.+?)\}/g,function(b,e){var j=h[e];if("function"===typeof j)j=j(e);return"undefined"===typeof j?"":j});else{var i=Array.prototype.slice.call(arguments,1),g=i.length;return d.replace(/\{(\d+)\}/g,
function(b,e){e=parseInt(e,10);return e>=g?b:i[e]})}return d}}}(jQuery);dxn.subView=function(){var c,a;return{curParam:{set:function(f){c=f},get:function(){return c}},curTarget:{set:function(f){a=f},get:function(){return a}}}}(jQuery);
dxn.dataTable=function(c){var a=c(".list-table"),f=a.find(".js-sort");a=a.find("tbody");var d=a.find("span[qtip=1]"),h=a.find(".table-btn[action!=]"),i=a.find("input[name=select]"),g={del:a.find(".js-opt-del"),audit:a.find(".js-opt-audit"),move:a.find(".js-opt-move"),flag:a.find(".js-opt-flag"),undoRej:a.find(".js-opt-undo-rej"),preview:a.find(".js-opt-preview")};a.find("tr:odd").addClass("tr-odd");a.find("tr").hover(function(){c(this).addClass("tr-hover")},function(){c(this).removeClass("tr-hover")});
f.each(function(){var b=c(this),e=b.attr("order_by"),j="asc",l=dxn.util.param.get("order_by"),k=dxn.util.param.get("sort_type");if(e===l){if(k==="asc")j="desc";b.append('<span class="sort-'+k+'"></span>')}b.click(function(){dxn.util.param.set({order_by:e,sort_type:j,page:"1"})});b.hover(function(){b.addClass("js-sort-hover")},function(){b.removeClass("js-sort-hover")})});d.qtip({style:{name:"blue"},position:{target:"mouse"}});h.each(function(){var b=c(this),e=b.attr("size_x");e=e===""?280:parseInt(e,
10);b.qtip({show:{when:"click",solo:true},hide:{when:"click"},position:{corner:{target:"rightBottom",tooltip:"rightTop"},adjust:{x:20,y:0}},style:{name:"blue",width:e},content:{text:"\u8f7d\u5165\u4e2d...",title:{text:b.attr("title"),button:"\u5173\u95ed"}},api:{beforeShow:function(){b.addClass("table-btn-active")},beforeHide:function(){b.removeClass("table-btn-active");this.updateContent(this.options.content.text)},onShow:function(){dxn.subView.curTarget.set(b);dxn.subView.curParam.set(b.closest("tr[row_id]").attr("row_id"));
this.loadContent(dxn.util.base+b.attr("action"),{v:dxn.util.version})}}})});i.click(function(){dxn.mutiOperation.dialogBtns.each(function(){c(this).qtip("api").hide()})});return{option:{getSelected:function(){var b=[];i.filter("[checked!=]").each(function(){b.push(c(this).val())});return b},getSelectedString:function(b){b||(b=",");return this.getSelected().join(b)},getSelectedCount:function(){return this.getSelected().length},setAll:function(){i.each(function(){this.checked=false;c(this).click()})},
setInverse:function(){i.each(function(){c(this).click()})}},btn:g}}(jQuery);
dxn.mutiOperation=function(c){var a=c(".operation-bar"),f=a.find(".operation-btn"),d=a.find(".operation-btn[action!=]"),h=a.find(".js-mutiopt-select"),i=a.find(".js-mutiopt-inverse");a.find(".js-mutiopt-del");a.find(".js-mutiopt-audit");a.find(".js-mutiopt-flag");a.find(".js-mutiopt-move");a.find(".js-mutiopt-undo-pub");a.find(".js-mutiopt-undo-rej");f.each(function(){var g=c(this);g.hover(function(){g.addClass("operation-btn-hover")},function(){g.removeClass("operation-btn-hover")})});h.click(dxn.dataTable.option.setAll);
i.click(dxn.dataTable.option.setInverse);d.each(function(){var g=c(this),b=g.attr("title");g.qtip({show:{when:"click",solo:true},hide:{when:"click"},position:{corner:{target:"bottomLeft",tooltip:"topLeft"},adjust:{x:-20,y:0}},style:{name:"blue",width:300},content:{text:"\u8f7d\u5165\u4e2d...",title:{text:"\u6279\u91cf"+b,button:"\u5173\u95ed"}},api:{beforeShow:function(){g.addClass("operation-btn-active")},beforeHide:function(){g.removeClass("operation-btn-active")},onShow:function(){var e=dxn.dataTable.option.getSelectedCount();
this.updateTitle(dxn.util.format("\u6279\u91cf{0}\uff1a\u9009\u4e2d<strong>{1}</strong>\u6761\u6570\u636e",b,e));this.loadContent(dxn.util.base+g.attr("action"),{v:dxn.util.version})}}})});return{dialogBtns:d}}(jQuery);
dxn.tableSearch=function(c){c=c(".list-search");var a=c.find(".search"),f=c.find(".keyword"),d=c.find("input");c=dxn.util.param.get("keyword");d.val(c).keypress(function(h){h.keyCode===13&&a.click()});a.click(function(){dxn.util.param.set({keyword:d.val()})});a.hover(function(){a.addClass("search-hover")},function(){a.removeClass("search-hover")});f.focusin(function(){f.addClass("keyword-focus")}).focusout(function(){f.removeClass("keyword-focus")})}(jQuery);
