var dxn=window.dxn||{};
dxn.util=function(b){var a=dxn.PAGEENV,f=a.param;return{base:a.base,param:{set:function(e){b.extend(f,e);window.location.search=b.param(f)},get:function(e){return f[e]||""}},version:a.version,format:function(e,i){e=String(e);if("undefined"!==typeof i)if("[object Object]"===Object.prototype.toString.call(i))return e.replace(/\$\{(\.+?)\}/g,function(g,h){var j=i[h];if("function"===typeof j)j=j(h);return"undefined"===typeof j?"":j});else{var d=Array.prototype.slice.call(arguments,1),c=d.length;return e.replace(/\{(\d+)\}/g,
function(g,h){h=parseInt(h,10);return h>=c?g:d[h]})}return e}}}(jQuery);dxn.subView=function(){var b,a;return{curParam:{set:function(f){b=f},get:function(){return b}},curTarget:{set:function(f){a=f},get:function(){return a}}}}(jQuery);
dxn.dataTable=function(b){var a=b(".list-table"),f=a.find(".js-sort");a=a.find("tbody");var e=a.find("span[qtip=1]"),i=a.find(".table-btn[action!=]"),d=a.find("input[name=select]");a.find("tr:odd").addClass("tr-odd");a.find("tr").hover(function(){b(this).addClass("tr-hover")},function(){b(this).removeClass("tr-hover")});f.each(function(){var c=b(this),g=c.attr("order_by"),h="asc",j=dxn.util.param.get("order_by"),k=dxn.util.param.get("sort_type");if(g===j){if(k==="asc")h="desc";c.append('<span class="sort-'+
k+'"></span>')}c.click(function(){dxn.util.param.set({order_by:g,sort_type:h,page:"1"})});c.hover(function(){c.addClass("js-sort-hover")},function(){c.removeClass("js-sort-hover")})});e.qtip({style:{name:"blue"},position:{target:"mouse"}});i.each(function(){var c=b(this),g=c.attr("size_x");g=g===""?280:parseInt(g,10);c.qtip({show:{when:"click",solo:true},hide:{when:"click"},position:{corner:{target:"rightBottom",tooltip:"rightTop"},adjust:{x:20,y:0}},style:{name:"blue",width:g},content:{text:"\u8f7d\u5165\u4e2d...",
title:{text:c.attr("title"),button:"\u5173\u95ed"}},api:{beforeShow:function(){c.addClass("table-btn-active")},beforeHide:function(){c.removeClass("table-btn-active");this.updateContent(this.options.content.text)},onShow:function(){dxn.subView.curTarget.set(c);dxn.subView.curParam.set(c.closest("tr[row_id]").attr("row_id"));this.loadContent(dxn.util.base+c.attr("action"),{v:dxn.util.version})}}})});d.click(function(){dxn.mutiOperation.dialogBtns.each(function(){b(this).qtip("api").hide()})});return{option:{getSelected:function(){var c=
[];d.filter("[checked!=]").each(function(){c.push(b(this).val())});return c},getSelectedString:function(c){c||(c=",");return this.getSelected().join(c)},getSelectedCount:function(){return this.getSelected().length},setAll:function(){d.each(function(){this.checked=false;b(this).click()})},setInverse:function(){d.each(function(){b(this).click()})}}}}(jQuery);
dxn.mutiOperation=function(b){var a=b(".operation-bar"),f=a.find(".operation-btn"),e=a.find(".operation-btn[action!=]"),i=a.find(".js-mutiopt-select");a=a.find(".js-mutiopt-inverse");f.each(function(){var d=b(this);d.hover(function(){d.addClass("operation-btn-hover")},function(){d.removeClass("operation-btn-hover")})});i.click(dxn.dataTable.option.setAll);a.click(dxn.dataTable.option.setInverse);e.each(function(){var d=b(this),c=d.attr("title");d.qtip({show:{when:"click",solo:true},hide:{when:"click"},
position:{corner:{target:"bottomLeft",tooltip:"topLeft"},adjust:{x:-20,y:0}},style:{name:"blue",width:300},content:{text:"\u8f7d\u5165\u4e2d...",title:{text:"\u6279\u91cf"+c,button:"\u5173\u95ed"}},api:{beforeShow:function(){d.addClass("operation-btn-active")},beforeHide:function(){d.removeClass("operation-btn-active")},onShow:function(){dxn.subView.curTarget.set(d);dxn.subView.curParam.set(dxn.dataTable.option.getSelectedString());var g=dxn.dataTable.option.getSelectedCount();this.updateTitle(dxn.util.format("\u6279\u91cf{0}\uff1a\u9009\u4e2d<strong>{1}</strong>\u6761\u6570\u636e",
c,g));this.loadContent(dxn.util.base+d.attr("action"),{v:dxn.util.version})}}})});return{dialogBtns:e}}(jQuery);dxn.tableSearch=function(b){b=b(".list-search");var a=b.find(".search"),f=b.find(".keyword"),e=b.find("input");b=dxn.util.param.get("keyword");e.val(b).keypress(function(i){i.keyCode===13&&a.click()});a.click(function(){dxn.util.param.set({keyword:e.val()})});a.hover(function(){a.addClass("search-hover")},function(){a.removeClass("search-hover")});f.focusin(function(){f.addClass("keyword-focus")}).focusout(function(){f.removeClass("keyword-focus")})}(jQuery);
